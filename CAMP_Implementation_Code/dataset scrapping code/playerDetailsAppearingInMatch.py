### This code extract player profiles for data given a match Id. Extarct profiles of each player on that match. 
from urllib.request import urlopen
import numpy as np
import pandas as pd
import json
import csv
import os
from bs4 import BeautifulSoup
import sys

import time
#ado=['722333', '749779', '754743', '766929', '766931', '858493', '766933', '858495', '743939', '743941', '810423', '870729', '810425', '860263', '860265', '860267', '743963', '743965', '817213', '743967', '817215', '743969', '895773', '895775', '743971', '895777', '902635', '915773', '915775', '902637', '902639', '892509', '903603', '892511', '903605', '903607', '892513', '903609', '914203', '892515', '914205', '892517', '800461', '657647', '592401', '657649', '657651', '690347', '690349', '667651', '648673', '667653', '648675', '648677', '730277', '667899', '730279', '667901', '730281', '667711', '730089', '667713', '730091', '667715', '745153', '667717', '736435', '745155', '667719', '730295', '730297', '727927', '760781', '727929', '760783', '742611', '760785', '742613', '742615', '754737', '754739', '722329', '749777', '754741', '722331', '567356', '573013', '567357', '567363', '567364', '598812', '567365', '598813', '569243', '602472', '593988', '569244', '598814', '602473', '593989', '569245', '598815', '623576', '623577', '566921', '566922', '566932', '566933', '566934', '566935', '566936', '659555', '659557', '668949', '649087', '668951', '649089', '676525', '676527', '592397', '661679', '592398', '661681', '592399', '648665', '661683', '592400', '648667', '657647', '518951', '514034', '518952', '531628', '518953', '531629', '520591', '531630', '520603', '520604', '520605', '521225', '521226', '540176', '540177', '540178', '534205', '534206', '534207', '562444', '562445', '562446', '534225', '560929', '534226', '560930', '534227', '565817', '565818', '573007', '587469', '565806', '582192', '587470', '573008', '565807', '582193', '573009', '565808', '565809', '573011', '573012', '463148', '428753', '473921', '473922', '489218', '489219', '474463', '474464', '474465', '489226', '489227', '489228', '474472', '474473', '522245', '474474', '474475', '516212', '523731', '516213', '516214', '530424', '531986', '530425', '531987', '527017', '530426', '535997', '514029', '535998', '514030', '535999', '518947', '518948', '538072', '514032', '538073', '518950', '514033', '406200', '387572', '406201', '387573', '434256', '434257', '441825', '441826', '423786', '426423', '423789', '426424', '423790', '426401', '426402', '439152', '439153', '439154', '426394', '456669', '426395', '456670', '426413', '456671', '426414', '426415', '426416', '464526', '464527', '464531', '464532', '461571', '464987', '464533', '461572', '464988', '428749', '464989', '428750', '428751', '463146', '428752', '463147', '351683', '378751', '352661', '352662', '390680', '388993', '350472', '352663', '388994', '350473', '352664', '366628', '350474', '386496', '366629', '380712', '380713', '403367', '345970', '401071', '403368', '345971', '401072', '403369', '345972', '345973', '403378', '345974', '403379', '430881', '423778', '430882', '406189', '430883', '423779', '406190', '423780', '406191', '387570', '406199', '387571', '291352', '298802', '300429', '298803', '300430', '291353', '291354', '323947', '323948', '300442', '300443', '300444', '319132', '332911', '332912', '319133', '332913', '296900', '319139', '296901', '319140', '296902', '319141', '296909', '296910', '343729', '296911', '343730', '296912', '343731', '345669', '361758', '345670', '361759', '345671', '345672', '350345', '351679', '350346', '351680', '366705', '361050', '351681', '366706', '361051', '351682', '378750', '249226', '249217', '250665', '250666', '250667', '258459', '282691', '282692', '258460', '258461', '258462', '293478', '293479', '293480', '258468', '258469', '258470', '299004', '299005', '291338', '298793', '291339', '298794', '297806', '297807', '291222', '297808', '291223', '291224', '291351', '298801', '226373', '232615', '233797', '234783', '238167', '239025', '238168', '238180', '238186', '238201', '238181', '238187', '238202', '238182', '238216', '238203', '238217', '238171', '238205', '238172', '238206', '238207', '225264', '225265', '225266', '239920', '239921', '239922', '239923', '225255', '249193', '225256', '249194', '225257', '225258', '257765', '257766', '249222', '257767', '249223', '251485', '249224', '251486', '249215', '249225', '249216', '64115', '64118', '64121', '64119', '64122', '64120', '64123', '64125', '64128', '64124', '64126', '64129', '64127', '64130', '64131', '64133', '64132', '64134', '207334', '208321', '209929', '209930', '210366', '210368', '213347', '213856', '214009', '215010', '215253', '215686', '216055', '216994', '218383', '218813', '219062', '219612', '219613', '221840', '223889', '225443', '226120', '226350', '226348', '226351', '226361', '226362', '226371', '226363', '226372', '64062', '64065', '64066', '64069', '64070', '64071', '64074', '64077', '64072', '64075', '64078', '64073', '64076', '64081', '64079', '64082', '64080', '64083', '64084', '64085', '64086', '64089', '64087', '64090', '64088', '64091', '64092', '64093', '64094', '64097', '64098', '64095', '64096', '64099', '64100', '64103', '64105', '64104', '64101', '64106', '64102', '64107', '64109', '64108', '64110', '64111', '64113', '64112', '64116', '64114', '64117', '64013', '64023', '64024', '64025', '64028', '64030', '64029', '64026', '64031', '64027', '64032', '64033', '64034', '64035', '64036', '64038', '64037', '64039', '64040', '64043', '64041', '64044', '64045', '64042', '64046', '64048', '64047', '64049', '64050', '64052', '64051', '64053', '64054', '64055', '64056', '64059', '64057', '64060', '64063', '64058', '64067', '64068', '64061', '64064', '812623', '810827', '749781', '810829', '812645', '749783', '754751', '722339', '749785', '810833', '754749', '722341', '810831', '749787', '754753', '722343', '749789', '754755', '749791', '722345', '754757', '722347', '749793', '754759', '749795', '754761', '749797', '656399', '656401', '656403', '656405', '656407', '656409', '656411', '656413', '656415', '656417', '656421', '656423', '656425', '656427', '656429', '656431', '656433', '656435', '656437', '656439', '656441', '656443', '656445', '656447', '656449', '656451', '656453', '656455', '656457', '656459', '656461', '656463', '656465', '656467', '656469', '656471', '656473', '656475', '656477', '656479', '656481', '656483', '656485', '656487', '656489', '656491', '656493', '656495', '858485', '858487', '858489', '760889', '868727', '868729', '868731', '743943', '743945', '743947', '743949', '870731', '743951', '870733', '870735', '885959', '817207', '860269', '885965', '817209', '885967', '817211', '860271', '860273', '860275', '860277', '894287', '894289', '894291', '848843', '848845', '848847', '743973', '743977', '743979', '743981', '743983', '743985', '919607', '919609', '919611', '919613', '903593', '919615', '919617', '903595', '924627', '924629', '903597', '924631', '924633', '903599', '924635', '903601', '915777', '915779', '931390', '915781', '931392', '931394', '902641', '902643', '911049', '902645', '911051', '902647', '953335', '914207', '914209', '953337', '914211', '661689', '661691', '661693', '636159', '636160', '667641', '636161', '667643', '696731', '696733', '636162', '667645', '636163', '696747', '667647', '696759', '667649', '696763', '690355', '690357', '690359', '702139', '710291', '710293', '710295', '710297', '636533', '710299', '710301', '636534', '710303', '710305', '710307', '636535', '710309', '710311', '736497', '736503', '736511', '706767', '684679', '667889', '667891', '667893', '667895', '667897', '744679', '744681', '744683', '730083', '730085', '730087', '756035', '756037', '756039', '756041', '736437', '736439', '730287', '736441', '730289', '745159', '736443', '730291', '745161', '736445', '667723', '736447', '745163', '667725', '736449', '736451', '667727', '736453', '667729', '736455', '727935', '727937', '727939', '727919', '770121', '727921', '770123', '727923', '770127', '749771', '749773', '749775', '792289', '792291', '791633', '791635', '792293', '792295', '754723', '754725', '792297', '754727', '754729', '760787', '754731', '760789', '760791', '750663', '760793', '803795', '750665', '803797', '760795', '803799', '750667', '803801', '750669', '742619', '750671', '742621', '750673', '742623', '750675', '742625', '742627', '589309', '589310', '573014', '565812', '573015', '565813', '573016', '565814', '567358', '573017', '567359', '573018', '565815', '567360', '565816', '573022', '573023', '573024', '573025', '573026', '569240', '569241', '593983', '569242', '593984', '593985', '592270', '592271', '567368', '592266', '592267', '567369', '567370', '567371', '602474', '567372', '602475', '602476', '623573', '623574', '623575', '601077', '601612', '601613', '602761', '566923', '566924', '566925', '578614', '578615', '578616', '578617', '578618', '578619', '578620', '578621', '578622', '578623', '578624', '578625', '566946', '566947', '566948', '597923', '631136', '597924', '631137', '597925', '597926', '631138', '597927', '631139', '597928', '597929', '645635', '645637', '645639', '635653', '645641', '635654', '643665', '645643', '643667', '635655', '643669', '635656', '635657', '643675', '643677', '659549', '660825', '659551', '660827', '659553', '566940', '566939', '660837', '566942', '660841', '566943', '566944', '566945', '661891', '661893', '647249', '647251', '647253', '647255', '668953', '647259', '649091', '668955', '649093', '647261', '668957', '649095', '649097', '668961', '649099', '668963', '668965', '676529', '676531', '685731', '676533', '685733', '685735', '648651', '648653', '648655', '657637', '657639', '657641', '657643', '661685', '657645', '514035', '514036', '514037', '514038', '514039', '520592', '518956', '520593', '518957', '520594', '518958', '545656', '518959', '531631', '518960', '531632', '518961', '543881', '531633', '518962', '543882', '518963', '531634', '518964', '520600', '518965', '518966', '520601', '518967', '520602', '518968', '518969', '518970', '535794', '535795', '535796', '535797', '540168', '535798', '540169', '535799', '540170', '535800', '540171', '540172', '543888', '543889', '562439', '562440', '562441', '562442', '534209', '562443', '534210', '534214', '534215', '534216', '555892', '560923', '534218', '560924', '534219', '555894', '560925', '560926', '560927', '564781', '564782', '564783', '564784', '564785', '534228', '571947', '534229', '571145', '534230', '571146', '534231', '571147', '534232', '582188', '582189', '582190', '582191', '587471', '587472', '587473', '587474', '587475', '589308', '463150', '463151', '446962', '463152', '446963', '463153', '473923', '446964', '463154', '473924', '446965', '473925', '446966', '464990', '473926', '446967', '473927', '464991', '473928', '446968', '464992', '433558', '433559', '433560', '433561', '433562', '433563', '433564', '433565', '433566', '433567', '433568', '433570', '433569', '433571', '433572', '433573', '433574', '433575', '433576', '433577', '433579', '433578', '433580', '433581', '433582', '433583', '433584', '433585', '433586', '433587', '433588', '433590', '433589', '433591', '433592', '433593', '433595', '433594', '433597', '433596', '433598', '433599', '433600', '433601', '433602', '433603', '433604', '433605', '433606', '503363', '503364', '503365', '489213', '489214', '489215', '489216', '489217', '507995', '507996', '489221', '489222', '489223', '489224', '489225', '504778', '474467', '504779', '474468', '474469', '474470', '474471', '506207', '506208', '518202', '518203', '516206', '522246', '522247', '516207', '522248', '516208', '522249', '516209', '522250', '516210', '483126', '474477', '474478', '523732', '474479', '523733', '474480', '523482', '523483', '523734', '474481', '523804', '523805', '531983', '521218', '531984', '521219', '531985', '514025', '527014', '521220', '527015', '521221', '514026', '527016', '521222', '514027', '530427', '530428', '530429', '530430', '530431', '536929', '538069', '536930', '538070', '536931', '538071', '536932', '536933', '434258', '434259', '434260', '434261', '434262', '434263', '434264', '406202', '406203', '406204', '406205', '406206', '423783', '406192', '423784', '406193', '423785', '406194', '406195', '441782', '441780', '441783', '441781', '406196', '441827', '441828', '441829', '426420', '426421', '423791', '439140', '426422', '423792', '439141', '423793', '439142', '423794', '439143', '423795', '439144', '448370', '448369', '439147', '439148', '452146', '439149', '452147', '439150', '452148', '452149', '439151', '452150', '452151', '452152', '455231', '442232', '455232', '426384', '455233', '455234', '426406', '455235', '455236', '426387', '455237', '426388', '426389', '426390', '450370', '450371', '450372', '450373', '450374', '450375', '426391', '450376', '450377', '450378', '450379', '450380', '450381', '426403', '450382', '450383', '450384', '450387', '450385', '450386', '426404', '426405', '450106', '450107', '450105', '456662', '456664', '456663', '450498', '464717', '450501', '464720', '473315', '456666', '456665', '456668', '464723', '464724', '426428', '426429', '426430', '426431', '426432', '474453', '474454', '474455', '476596', '470624', '470625', '476598', '470626', '476599', '463143', '476600', '463144', '464529', '463145', '461566', '461567', '461568', '446957', '446958', '461569', '446959', '461570', '467883', '486520', '467884', '486522', '467885', '486523', '467886', '467887', '486526', '366710', '366711', '366712', '378753', '378754', '366713', '378755', '378756', '351684', '351685', '378757', '385749', '378758', '385750', '378759', '351686', '385751', '351687', '385023', '386530', '385024', '351688', '385025', '386531', '351689', '385026', '386532', '385027', '386533', '351690', '351691', '386534', '351692', '351693', '366623', '366626', '366627', '366624', '366625', '352665', '352666', '352667', '352668', '390204', '390205', '350477', '352669', '350478', '390221', '390219', '390226', '390227', '350479', '350480', '350481', '390253', '390251', '390252', '392616', '392617', '392618', '392619', '392620', '380715', '380716', '377313', '377314', '377315', '377316', '408621', '408622', '408623', '409070', '408624', '410557', '401073', '401074', '403370', '401075', '403371', '403372', '403373', '410337', '403374', '410338', '410339', '410340', '410341', '415162', '408627', '420994', '383275', '350042', '415172', '415173', '350043', '350044', '403380', '350045', '403382', '403381', '350046', '403383', '350047', '350048', '350049', '415273', '415274', '415275', '415276', '415277', '415278', '415279', '415280', '415281', '415282', '415283', '415284', '415285', '415286', '415287', '424849', '424851', '424852', '426217', '426219', '416236', '422626', '416237', '422627', '422628', '416238', '416239', '422629', '426720', '422630', '416240', '426721', '416241', '430508', '426722', '430509', '387566', '387567', '387568', '430886', '430887', '430888', '430889', '430890', '298805', '325800', '325801', '298806', '325802', '298807', '325803', '298808', '325804', '291359', '298809', '291360', '291361', '300437', '291362', '291363', '300438', '300439', '291364', '291365', '291366', '300440', '291367', '300441', '291368', '291369', '291370', '291371', '291372', '323949', '323950', '323951', '335633', '335634', '335635', '343759', '319134', '343760', '319135', '343761', '319136', '343762', '343763', '345468', '345469', '345470', '345471', '296904', '296905', '296906', '335346', '335347', '319143', '335348', '335349', '296907', '335351', '335350', '319144', '296908', '335352', '325568', '335353', '319145', '325569', '335354', '325554', '325570', '325556', '335355', '325555', '335356', '335357', '319146', '335358', '319147', '325578', '325579', '325580', '354117', '325572', '343732', '314670', '349904', '343733', '349902', '325574', '296914', '349901', '343734', '325575', '349903', '325576', '296915', '366341', '343736', '296916', '336201', '296917', '336202', '296918', '336204', '361755', '361756', '361757', '325581', '325582', '325583', '360800', '360801', '350348', '350349', '374059', '361043', '374060', '374061', '361044', '361045', '375456', '375457', '361046', '375460', '361047', '375461', '375462', '366709', '251491', '251492', '251493', '249232', '249228', '249236', '273228', '273229', '249233', '249229', '267706', '273231', '249237', '273232', '273230', '267707', '249234', '267708', '249230', '267379', '249238', '267378', '267380', '267709', '267382', '267381', '267383', '249235', '267386', '267384', '267385', '249231', '267387', '267388', '267389', '275754', '250668', '267390', '267391', '267392', '249239', '275755', '267393', '250669', '267710', '249240', '275756', '250670', '275757', '249241', '267712', '250671', '267715', '250672', '251494', '267713', '251495', '251496', '274777', '274778', '274779', '247457', '247458', '247459', '247460', '247461', '247463', '247462', '247464', '247465', '247466', '247467', '247468', '247469', '247471', '247470', '247472', '247473', '247475', '247474', '247476', '247477', '247478', '247479', '247480', '247481', '247482', '247483', '247484', '247485', '247486', '247487', '247488', '247489', '247490', '247491', '247492', '247493', '247494', '247495', '247496', '247497', '247498', '247499', '247500', '247501', '247502', '247503', '247504', '247505', '247506', '247507', '282688', '282689', '293504', '293505', '293506', '289107', '289108', '289110', '293071', '293072', '293076', '293077', '258465', '293078', '296566', '258466', '258467', '295784', '295792', '295786', '295785', '295788', '295787', '293481', '293482', '293483', '275789', '296586', '296587', '258471', '300486', '258472', '300487', '300488', '258473', '258474', '258475', '258476', '258477', '297793', '291217', '297794', '291218', '297795', '291219', '297796', '291220', '297797', '291221', '297798', '297799', '299006', '296685', '299007', '296687', '299008', '313992', '299009', '313993', '313994', '299010', '297801', '297802', '297803', '297804', '297805', '298796', '317578', '298797', '317579', '298798', '317580', '317581', '291345', '291346', '291347', '300426', '300427', '300428', '226391', '226392', '226393', '226379', '226375', '226383', '226376', '226380', '226384', '226381', '226382', '226385', '226377', '226378', '235831', '226386', '236358', '236520', '236595', '236809', '236963', '237222', '237568', '237571', '237574', '238176', '238169', '238177', '238170', '238208', '238209', '238196', '238178', '238210', '238211', '238197', '238179', '238198', '238199', '238200', '239902', '238213', '238214', '239903', '238215', '239904', '239905', '238188', '238189', '238190', '238191', '238193', '238194', '244510', '244511', '238173', '238174', '238175', '239907', '239908', '239910', '239911', '239912', '239913', '247359', '247360', '247361', '239915', '247363', '239916', '239917', '239918', '239919', '225171', '225250', '225251', '225252', '240777', '225253', '225254', '247827', '247828', '249203', '249204', '249205', '249206', '253010', '251480', '249207', '253016', '251481', '253018', '249378', '249379', '249380', '256665', '251469', '251470', '225245', '225246', '225247', '225248', '225249', '256606', '256607', '255961', '256608', '256610', '259793', '256612', '257470', '256614', '256615', '249739', '249740', '249741', '249742', '249743', '249744', '249745', '249746', '249747', '249748', '249749', '249750', '249751', '249752', '249753', '249754', '249755', '249756', '249757', '249758', '249759', '258006', '258007', '258008', '249211', '259388', '249212', '259384', '259385', '249213', '264066', '259390', '259391', '259389', '264068', '249214', '264069', '257769', '264070', '264071', '257770', '257771', '264075', '257772', '264076', '251489', '251490', '66387', '65657', '65658', '65659', '64918', '65660', '65661', '64919', '64920', '65662', '65663', '64921', '65664', '64922', '64923', '65665', '64924', '65666', '64925', '65667', '64926', '64927', '64928', '64929', '64930', '64931', '64932', '64933', '64934', '64935', '64936', '64937', '64938', '64939', '64940', '64941', '64942', '64943', '208811', '208835', '209027', '209297', '209339', '209582', '209733', '209768', '211244', '211364', '211425', '211579', '211678', '211824', '211860', '212020', '212253', '212452', '212795', '213080', '213288', '214634', '214742', '214852', '214921', '215134', '215286', '215449', '216271', '216591', '216669', '216929', '217116', '217481', '217647', '217648', '217810', '217811', '217978', '217979', '218250', '220935', '221083', '221337', '222857', '223018', '223334', '223335', '223542', '223634', '223902', '224044', '224227', '224231', '224556', '225437', '225959', '226315', '226358', '226359', '226364', '226365', '226366', '226352', '226353', '226354', '226355', '226356', '226390', '64857', '64858', '65643', '64859', '65644', '64860', '65645', '65646', '64861', '65647', '65648', '65649', '65650', '64862', '65651', '64863', '65652', '64864', '65653', '64865', '65654', '64866', '65655', '65656', '64867', '64868', '64869', '64870', '64871', '64872', '64873', '64874', '64875', '64876', '64877', '64878', '64879', '64880', '64881', '64882', '64883', '64884', '64885', '64886', '64887', '64888', '64889', '64890', '64891', '64892', '64893', '64894', '64895', '64896', '64897', '64898', '64899', '64900', '64901', '66303', '66304', '66305', '66306', '66307', '66308', '66309', '66310', '66311', '65706', '65707', '65708', '65709', '65710', '65711', '65712', '65713', '65714', '65715', '65716', '65717', '65718', '64902', '66374', '64903', '66375', '64904', '64905', '66376', '64906', '65032', '65033', '66377', '65034', '66196', '66197', '66198', '66199', '66200', '66201', '66202', '66203', '66204', '66205', '66206', '66207', '66208', '66209', '66210', '66378', '66379', '66380', '66381', '66382', '66383', '64907', '64908', '64909', '66384', '64910', '64911', '64912', '66385', '64913', '66386', '64914', '64915', '64916', '64917', '64815', '64816', '64817', '65634', '65635', '64818', '65636', '64819', '65637', '65638', '65639', '65640', '65641', '65642', '65235', '65236', '65237', '65238', '65239', '65240', '65241', '65242', '65243', '65244', '65245', '65246', '65247', '65248', '65249', '65250', '65251', '65252', '65253', '65254', '65255', '65256', '65257', '65258', '65259', '65260', '65261', '65262', '65263', '65264', '65265', '65266', '65267', '65268', '65269', '65270', '65271', '65272', '65273', '65274', '65275', '65276', '65277', '65278', '65279', '65280', '65281', '65282', '65283', '65284', '65285', '65286', '65803', '65804', '65805', '65806', '65807', '65808', '65809', '66350', '66351', '66352', '66353', '66354', '66355', '66356', '66357', '66358', '66359', '64820', '66360', '64821', '66361', '66362', '64822', '66363', '64823', '64824', '64825', '64826', '64827', '64828', '64829', '65029', '65030', '65031', '66293', '66294', '66295', '66296', '66297', '66298', '66299', '66300', '66301', '66302', '64830', '64831', '64832', '64833', '64834', '64835', '64836', '64837', '64838', '64839', '64840', '64841', '64842', '66364', '66365', '66366', '66367', '66368', '66369', '64843', '66370', '64844', '64845', '66371', '66372', '64846', '66373', '64847', '64848', '64849', '64851', '64850', '64852', '64853', '64854', '64855', '64856', '722335', '722337', '736063', '858491', '868723', '868725', '876463', '876465', '889463', '876467', '743953', '883341', '883343', '883345', '883347', '817203', '817205', '875457', '875459', '875467', '875471', '875481', '875485', '875491', '875501', '875507', '875513', '885969', '875521', '885971', '875541', '875545', '875549', '875551', '875553', '860279', '860281', '894293', '848839', '848841', '743975', '919603', '919605', '903587', '903589', '924637', '924639', '915783', '915785', '931396', '931398', '930575', '930573', '930577', '930579', '902649', '902651', '930581', '930583', '930585', '902653', '661695', '661697', '636164', '636165', '636166', '690351', '690353', '702141', '702143', '636536', '636537', '648681', '636538', '648683', '682897', '682899', '682901', '682903', '682905', '682907', '682909', '682911', '682913', '682915', '682917', '682919', '682921', '682923', '682925', '682927', '682929', '682931', '682933', '682935', '682937', '682939', '682941', '682943', '682945', '682947', '682949', '682951', '682953', '682955', '682957', '682959', '682961', '682963', '682965', '667887', '730283', '730285', '730293', '667731', '727917', '754717', '754719', '754721', '802327', '742617', '754039', '573019', '573020', '569237', '569238', '573027', '569239', '593986', '567367', '592272', '593987', '592273', '592268', '592269', '602477', '630951', '592276', '623571', '623572', '566926', '566927', '631573', '631574', '645645', '645647', '635658', '635659', '635660', '659545', '659547', '566937', '566938', '662383', '647247', '662387', '668959', '649101', '660107', '649103', '660123', '660113', '660149', '685727', '668969', '660173', '685729', '660185', '660203', '660209', '660223', '660235', '657631', '657633', '657635', '518954', '518955', '520595', '520596', '520597', '520598', '520599', '543883', '543884', '531635', '543885', '531636', '531637', '546410', '546411', '546414', '546418', '546443', '546442', '546462', '546463', '546470', '546473', '546477', '540173', '556252', '540174', '562437', '562438', '534208', '560921', '560922', '567071', '567072', '567073', '567204', '567205', '573672', '564786', '571148', '571149', '534233', '571150', '534234', '565820', '534235', '533272', '533273', '533274', '533275', '533276', '533277', '533278', '533279', '533280', '533281', '533282', '533283', '533284', '533285', '533286', '533287', '533288', '533289', '533290', '533291', '533292', '533293', '533294', '533295', '533296', '533297', '533298', '582186', '587476', '565810', '567353', '565811', '567354', '589306', '567355', '589307', '463149', '446960', '446961', '489212', '489220', '474466', '516204', '516205', '474476', '523735', '523736', '525816', '525817', '531982', '514023', '527012', '514024', '527013', '521217', '530432', '538068', '440224', '440100', '440218', '423782', '440219', '441640', '406207', '439495', '439497', '439500', '439499', '439506', '439505', '439507', '439510', '439511', '440945', '440946', '406197', '406198', '423787', '423788', '439139', '412678', '412677', '412679', '412680', '412682', '412683', '412686', '412685', '412684', '412681', '412688', '412687', '412689', '412690', '412691', '412692', '412693', '412694', '412695', '412696', '412697', '412698', '412699', '412700', '412701', '412702', '412703', '439146', '447539', '456991', '456992', '452153', '452154', '426392', '426393', '426417', '426418', '463141', '463142', '478279', '461565', '446956', '473918', '473919', '473920', '351694', '351695', '386535', '351696', '386494', '366622', '352674', '350475', '350476', '392615', '355991', '355992', '355993', '355994', '355995', '355996', '355997', '355998', '355999', '356000', '356002', '356001', '356003', '356004', '356005', '356006', '356007', '356008', '356009', '356010', '356012', '356011', '356013', '356014', '356015', '356016', '356017', '401076', '403375', '350050', '403385', '403386', '426723', '426724', '387563', '387564', '430884', '430885', '298804', '291356', '300435', '300436', '343764', '296903', '319142', '354453', '354454', '354455', '354456', '354457', '354458', '361530', '361531', '354459', '354460', '354461', '361653', '361654', '361655', '361656', '361657', '361658', '361659', '361660', '350347', '366707', '366708', '249227', '255957', '258463', '258464', '306987', '306989', '306991', '287853', '287854', '287855', '287856', '287857', '287858', '287859', '287860', '287861', '287862', '287863', '287864', '287865', '287866', '287867', '287868', '287869', '287870', '287871', '287872', '287873', '287874', '287875', '287876', '287877', '287878', '287879', '297800', '298795', '291343', '319112', '226374', '237242', '238195', '225271', '225263', '264065', '255954', '251487', '251488', '211048', '211028', '222678']



allMatchSummary = pd.read_csv('C:/python/Scripts/JupyterNotebooks/matchSummary/allODIMatchesSummary_DetailInfo_2001_2019.csv', sep=',')

allMatchSummary.drop(['Unnamed: 0'], axis=1, inplace=True)

#allMatchSummary.year.unique()



print("matchplayerCountnt", len(allMatchSummary))

#matchIds= ["65629","65630","65631","65632","65633"]  # match Ids, for which match records needs to be extracted.
errlist=[]
#setting up the master json.
master={}

master['Players']= {}

ef = open("all_error_players", 'w')
playerCount=0
for matid in allMatchSummary['matchId']: #for matid in matchIds:#ado:
	if(playerCount%50==0):
		print('done', playerCount)
	try:
		playerCount=playerCount+1
		
		pl1= "http://www.espncricinfo.com/ci/engine/match/"+str(matid)+".json?xhr=1"
		souppl1 = BeautifulSoup(urlopen(pl1).read(), "lxml")
		souppl1.prettify()
		w1=souppl1.find('body')
		b1=w1.text
		js1=str(b1)
		inp1=json.loads(js1)
		t0= inp1['team'][0]['team_name']
		t1=inp1['team'][1]['team_name']
	
		for n in inp1['team'][0]['player']:
			if n['object_id'] in master['Players']:
				continue			
			else:
				master['Players'][n['object_id']]={}
				master['Players'][n['object_id']]['team'] = t0
				master['Players'][n['object_id']]['player_id'] = n['player_id']
				master['Players'][n['object_id']]['age_years'] = n['age_years']
				master['Players'][n['object_id']]['name'] = n['known_as']

				master['Players'][n['object_id']]['batting_hand'] = n['batting_hand']
				master['Players'][n['object_id']]['batting_style_long'] = n['batting_style_long']
				master['Players'][n['object_id']]['batting_style'] = n['batting_style']

				master['Players'][n['object_id']]['bowling_hand'] = n['bowling_hand']
				master['Players'][n['object_id']]['bowling_pacespin'] = n['bowling_pacespin']
				master['Players'][n['object_id']]['bowling_style'] = n['bowling_style']
				master['Players'][n['object_id']]['bowling_style_long'] = n['bowling_style_long']

				master['Players'][n['object_id']]['player_primary_role'] = n['player_primary_role']

		for n in inp1['team'][1]['player']:
			if n['object_id'] in master['Players']:
				continue
			else:
				master['Players'][n['object_id']]={}
				master['Players'][n['object_id']]['team'] = t1
				master['Players'][n['object_id']]['player_id'] = n['player_id']
				master['Players'][n['object_id']]['age_years'] = n['age_years']
				master['Players'][n['object_id']]['name'] = n['known_as']

				master['Players'][n['object_id']]['batting_hand'] = n['batting_hand']
				master['Players'][n['object_id']]['batting_style_long'] = n['batting_style_long']
				master['Players'][n['object_id']]['batting_style'] = n['batting_style']

				master['Players'][n['object_id']]['bowling_hand'] = n['bowling_hand']
				master['Players'][n['object_id']]['bowling_pacespin'] = n['bowling_pacespin']
				master['Players'][n['object_id']]['bowling_style'] = n['bowling_style']
				master['Players'][n['object_id']]['bowling_style_long'] = n['bowling_style_long']

				master['Players'][n['object_id']]['player_primary_role'] = n['player_primary_role']

		with open('All_Players_2001_19.json', 'w') as json_file:
		    	json.dump(master, json_file)
	except Exception:
		errlist.append(matid)





ef.write(str(errlist))
'''

http://www.espncricinfo.com/ci/engine/match/live/centre/903587.json?bowler=12894;card=bowling;innings=2;xhr=1
		
'''		
